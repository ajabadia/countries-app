<!-- Encabezado de la página -->
<app-ui-heading [title]="entityNamePlural" />

<!-- Barra de herramientas y búsqueda -->
<div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-4">
  <app-toolbar-buttons [buttons]="toolbarButtons" />
  <app-search-box (searchChange)="searchChange.emit($any($event.target).value)" />
</div>

<!-- Tabla de datos -->
<ng-container *ngIf="state.response() as response">
  <app-table
    *ngIf="response"
    [columns]="tableColumns"
    [data]="response.data"
    [sort]="state.sort()"
    (sortChange)="sortChange.emit($event)"
    [selection]="state.selection()"
    (edit)="edit.emit($event)"
  />

  <!-- Paginador -->
  <app-paginator
    *ngIf="response && response.total > 0"
    [currentPage]="state.page()"
    [pageSize]="state.pageSize()"
    [totalItems]="response.total"
    (pageChange)="pageChange.emit($event)"
  />
</ng-container>

<!-- Indicador de carga -->
<div *ngIf="state.isLoading()" class="text-center p-8">
  <p>Cargando...</p>
</div>

<!-- Modal para Crear/Editar -->
<app-modal [isVisible]="state.isModalVisible()" (close)="state.hideModal()">
  <h3 class="text-lg font-medium leading-6 text-gray-900" modal-title>{{ editingEntity ? 'Editar' : 'Nuevo' }} {{ entityName }}</h3>
  <ng-content select="[form-content]"></ng-content>
  <div modal-actions class="flex justify-end gap-2 mt-4">
    <button (click)="state.hideModal()" class="btn btn-secondary">Cancelar</button>
    <button (click)="save.emit()" class="btn btn-primary" [disabled]="form.invalid">Guardar</button>
  </div>
</app-modal>

<!-- Diálogo de Confirmación para Eliminar -->
<app-confirm-dialog [isVisible]="state.isConfirmDialogVisible()" (close)="state.hideConfirmDialog()" (confirm)="confirmDelete.emit()" />