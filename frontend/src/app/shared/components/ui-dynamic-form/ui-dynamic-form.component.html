<!-- File: d:\desarrollos\countries2\frontend\src\app\shared\components\ui-dynamic-form\ui-dynamic-form.component.html | New File -->

<div class="dynamic-form" [formGroup]="form">
  @for (field of fields; track field.name) {
    <div class="form-field">
      <label [for]="field.name">{{ field.label }}</label>

      @switch (field.type) {
        @case ('boolean') {
          <input
            type="checkbox"
            [id]="field.name"
            [formControlName]="field.name"
          />
        }
        @case ('select') {
          <select [id]="field.name" [formControlName]="field.name">
            @for (option of field.options; track option.value) {
              <option [value]="option.value">{{ option.label }}</option>
            }
          </select>
        }
        @case ('textarea') {
          <textarea
            [id]="field.name"
            [formControlName]="field.name"
            [placeholder]="field.placeholder || ''"
          ></textarea>
        }
        @default {
          <input
            [type]="field.type"
            [id]="field.name"
            [formControlName]="field.name"
            [placeholder]="field.helpText || field.label"
            [title]="field.helpText || field.label"
            [class.is-invalid]="form.get(field.name)?.invalid && form.get(field.name)?.touched"
            [attr.maxlength]="field.maxLength"
            (input)="onInput($event, field)"
          />
        }
      }

      <!-- Mostramos el componente de error solo si el campo ha sido "tocado" -->
      @if (form.get(field.name)?.touched) {
        <app-ui-form-field-error [control]="form.get(field.name)" />
      }
    </div>
  }
</div>