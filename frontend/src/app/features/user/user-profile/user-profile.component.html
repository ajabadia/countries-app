<div class="profile-container">
  <h1>Mi Perfil</h1>
  <p>Gestiona tu información personal y tu seguridad.</p>

  <div class="profile-cards">
    <!-- Tarjeta de Datos del Perfil -->
    <app-ui-card>
      <h2 ui-card-title>Datos del Perfil</h2>
      <div ui-card-content>
        <form [formGroup]="profileForm" (ngSubmit)="onUpdateProfile()" class="profile-form">
          <div class="form-field">
            <label for="name">Nombre</label>
            <input id="name" type="text" formControlName="name" appUiInput placeholder="Tu nombre completo" />
            @if (profileForm.get('name')?.hasError('required') && profileForm.get('name')?.touched) {
              <small class="error-text">El nombre es obligatorio.</small>
            }
          </div>
          <div class="form-field">
            <label for="email">Email</label>
            <input id="email" type="email" formControlName="email" appUiInput placeholder="tu.email@ejemplo.com" />
            @if (profileForm.get('email')?.hasError('required') && profileForm.get('email')?.touched) {
              <small class="error-text">El email es obligatorio.</small>
            }
            @if (profileForm.get('email')?.hasError('email') && profileForm.get('email')?.touched) {
              <small class="error-text">Por favor, introduce un email válido.</small>
            }
          </div>
          <button app-ui-button type="submit" [disabled]="profileForm.pristine || profileForm.invalid">
            Actualizar Perfil
          </button>
        </form>
      </div>
    </app-ui-card>

    <!-- Tarjeta de Cambio de Contraseña -->
    <app-ui-card>
      <h2 ui-card-title>Cambiar Contraseña</h2>
      <div ui-card-content>
        <form [formGroup]="passwordForm" (ngSubmit)="onChangePassword()" class="profile-form">
          <div class="form-field">
            <label for="currentPassword">Contraseña Actual</label>
            <input id="currentPassword" type="password" formControlName="currentPassword" appUiInput placeholder="Tu contraseña actual" />
            @if (passwordForm.get('currentPassword')?.hasError('required') && passwordForm.get('currentPassword')?.touched) {
              <small class="error-text">La contraseña actual es obligatoria.</small>
            }
          </div>
          <div class="form-field">
            <label for="newPassword">Nueva Contraseña</label>
            <input id="newPassword" type="password" formControlName="newPassword" appUiInput placeholder="Mínimo 8 caracteres" />
            @if (passwordForm.get('newPassword')?.hasError('required') && passwordForm.get('newPassword')?.touched) {
              <small class="error-text">La nueva contraseña es obligatoria.</small>
            }
            @if (passwordForm.get('newPassword')?.hasError('minlength') && passwordForm.get('newPassword')?.touched) {
              <small class="error-text">La nueva contraseña debe tener al menos 8 caracteres.</small>
            }
          </div>
          <div class="form-field">
            <label for="confirmPassword">Confirmar Nueva Contraseña</label>
            <input id="confirmPassword" type="password" formControlName="confirmPassword" appUiInput />
            @if (passwordForm.get('confirmPassword')?.hasError('required') && passwordForm.get('confirmPassword')?.touched) {
              <small class="error-text">Confirmar la contraseña es obligatorio.</small>
            }
            @if (passwordForm.hasError('mismatch') && passwordForm.get('confirmPassword')?.touched) {
              <small class="error-text">Las contraseñas no coinciden.</small>
            }
          </div>
          <button app-ui-button type="submit" [disabled]="passwordForm.invalid">Cambiar Contraseña</button>
        </form>
      </div>
    </app-ui-card>
  </div>

  <button app-ui-button (click)="onLogout()" ui-button-color="danger" class="logout-button">Cerrar Sesión</button>
</div>