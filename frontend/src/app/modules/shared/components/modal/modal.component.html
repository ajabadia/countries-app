<!-- 1. Unificamos todo en un solo bloque @if para evitar redundancia -->
@if (visible) {
  <!-- ng-container es un agrupador que no añade elementos extra al DOM -->
  <ng-container>
    <div
      class="modal-backdrop"
      [@fade]
      (click)="onBackdropClick()"></div>
    <div
      class="modal-container"
      [@fade]
      role="dialog"
      aria-modal="true"
      [attr.aria-labelledby]="title ? 'modal-title-' + title : null"
      aria-describedby="modal-body-content">
      
      @if (title) {
      <app-ui-heading
        [id]="'modal-title-' + title"
        class="modal-header"
        [level]="3"
        [icon]="icon"
        [subtitle]="subtitle"
        color="primary">
        <!-- ✅ FIX: El título se pasa por proyección de contenido, no por el input [text]. -->
        {{ title }}

        @if (showCancel) {
          <!-- 2. Usamos &times; que es más semántico para un botón de cierre -->
          <button type="button" class="modal-close" (click)="onClose()" aria-label="Cerrar">&times;</button>
        }
      </app-ui-heading>
    }

    <!-- 3. Añadimos un ID para usarlo con aria-describedby -->
    <div class="modal-body" id="modal-body-content">
      <ng-content></ng-content>
    </div>

    @if (showAccept || showCancel) {
      <div class="modal-footer">
        @if (showCancel) {
          <app-ui-button color="surface" (onClick)="onClose()">{{ cancelLabel }}</app-ui-button>
        }
        @if (showAccept) {
          <app-ui-button color="primary" [disabled]="acceptDisabled" (onClick)="onAccept()">{{ acceptLabel }}</app-ui-button>
        }
      </div>
    }
    </div>
  </ng-container>
}