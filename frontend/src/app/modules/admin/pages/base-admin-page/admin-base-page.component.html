<!-- 
  Plantilla genérica para todas las páginas de administración que heredan de BaseAdminComponent.
  Utiliza las propiedades y métodos de la clase base para renderizar la UI.
-->
<div class="admin-page-container">
  <!-- Cabecera y botones de la barra de herramientas -->
  <header class="admin-page-header">
    <app-ui-heading [title]="entityNamePlural" />
    <app-toolbar-buttons [buttons]="toolbarButtons" />
  </header>

  <!-- Caja de búsqueda -->
  <app-search-box 
    (valueChange)="onSearchChange($event)"
  />

  <!-- Contenedor principal con la tabla y el paginador -->
  <main class="admin-page-content" *ngIf="response$ | async as response">
    <app-table
      [columns]="tableColumns"
      [items]="response?.data || []"
      (sortChange)="onSortChange($event)"
      (edit)="onEdit($event)"
      [selection]="selection"
    />

    <app-paginator
      [currentPage]="page$.getValue()"
      [pageSize]="pageSize$.getValue()"
      [totalItems]="response?.total || 0"
      (pageChange)="onPageChange($event)"
    />
  </main>

  <!-- Indicador de carga -->
  <div *ngIf="isLoading" class="loading-overlay">
    <!-- Aquí podrías poner un spinner -->
    Cargando...
  </div>

  <!-- Modal para crear/editar -->
  <app-modal [visible]="isModalVisible" (close)="closeModal()">
    <h3 class="modal-title">{{ editingEntity ? 'Editar' : 'Nuevo' }} {{ entityName }}</h3>
    <!-- Aquí se proyectará el formulario específico de cada entidad -->
    <ng-content select="[form-content]"></ng-content>
    <div class="modal-actions">
      <button (click)="closeModal()" class="btn btn-secondary">Cancelar</button>
      <button (click)="onSave()" class="btn btn-primary" [disabled]="form.invalid">Guardar</button>
    </div>
  </app-modal>

  <!-- Diálogo de confirmación para eliminar -->
  <app-confirm-dialog
    [visible]="isConfirmDialogVisible"
    title="Confirmar Eliminación"
    message="¿Estás seguro de que quieres eliminar los {{ selection.count }} elementos seleccionados?"
    (confirm)="onConfirmDelete()"
    (close)="closeConfirmDialog()"
  />
</div>