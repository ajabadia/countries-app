<div class="countries-admin">
  <app-ui-heading
    [level]="1"
    text="Países"
    icon="icon-country"
    color="primary"
  ></app-ui-heading>

  <div class="table-controls">
    <div class="controls-left">
      @if (toolbarButtons.length > 0) {
        <app-toolbar-buttons
          [buttons]="toolbarButtons">
        </app-toolbar-buttons>
      }
    </div>
    <div class="controls-right">
      <app-search-box
        [value]="searchTerm"
        (valueChange)="onValueChange($event)"
        placeholder="Buscar país..."
      ></app-search-box>
    </div>
  </div>

  <app-country-table
    [countries]="countries"
    [selectedCountries]="selectedCountries"
    [columns]="columns"
    [sortKey]="sortKey || ''"
    [sortOrder]="sortOrder"
    (selectionChange)="onSelectionChange($event)"
    (sortChange)="onSortChange($event)"
    (editCountry)="openEditModal($event)"
  ></app-country-table>

  <div class="paginator-wrapper">
    <app-paginator
      [page]="page"
      [totalPages]="totalPages"
      [totalItems]="totalCountries"
      [pageSize]="pageSize"
      (pageChange)="onPageChange($event)"
      (pageSizeChange)="onPageSizeChange($event)"
    ></app-paginator>
  </div>
</div>

@if (showEditModal) {
  <app-modal
    [visible]="showEditModal"
    [title]="editMode ? 'Editar país' : 'Nuevo país'"
    [subtitle]="editMode && pais ? pais.defaultname : ''"
    [acceptLabel]="editMode ? 'Guardar' : 'Crear'"
    [acceptDisabled]="countryForm.invalid"
    [icon]="editMode ? 'icon-edit' : 'icon-add'"
    [showCancel]="true"
    (accept)="saveCountry()"
    (close)="closeCountryModal()"
    >
    <form [formGroup]="countryForm" class="modal-form">
    </form>
  </app-modal>
}

<app-confirm-dialog
  [visible]="showConfirmDelete"
  title="Confirmar eliminación"
  message="¿Estás seguro de que quieres eliminar el país: {{ pais?.defaultname }}?"
  variant="warning"
  (confirm)="eliminarPais()"
  (cancel)="cancelarEliminar()"
></app-confirm-dialog>